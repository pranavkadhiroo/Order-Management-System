generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id        String    @id @default(uuid())
  username  String    @unique
  password  String
  name      String?
  lastLogin DateTime?
  createdAt DateTime  @default(now())
  updatedAt DateTime  @updatedAt @default(now())
}

model Customer {
  id           String             @id @default(uuid())
  customerCode String             @unique
  customerName String
  telephone    String?
  email        String?
  country      String?
  city         String?
  state        String?
  salesPerson  String?
  createdAt    DateTime           @default(now())
  updatedAt    DateTime           @updatedAt
  deletedAt    DateTime?
  addresses    CustomerAddress[]
  contacts     CustomerContact[]
  documents    CustomerDocument[]
  orders       Order[]
}

model CustomerAddress {
  id         String   @id @default(uuid())
  customerId String
  customer   Customer @relation(fields: [customerId], references: [id], onDelete: Cascade)
  address    String
  city       String?
  state      String?
  country    String?
  telephone  String?
  createdAt  DateTime @default(now())
}

model CustomerContact {
  id          String   @id @default(uuid())
  customerId  String
  customer    Customer @relation(fields: [customerId], references: [id], onDelete: Cascade)
  contactName String
  email       String?
  phone       String?
  position    String?
  createdAt   DateTime @default(now())
}

model CustomerDocument {
  id           String   @id @default(uuid())
  customerId   String
  customer     Customer @relation(fields: [customerId], references: [id], onDelete: Cascade)
  fileName     String
  filePath     String
  fileType     String
  fileSize     Int
  notes        String?
  uploadedAt   DateTime @default(now())
}

model Order {
  id            String        @id @default(uuid())
  orderNumber   String        @unique
  orderDate     DateTime
  executionDate DateTime?
  customerId    String
  customer      Customer      @relation(fields: [customerId], references: [id])
  createdAt     DateTime      @default(now())
  updatedAt     DateTime      @updatedAt
  deletedAt     DateTime?
  details       OrderDetail[]
  containers    Container[]
  charges       Charge[]
}

model OrderDetail {
  id          String   @id @default(uuid())
  orderId     String
  order       Order    @relation(fields: [orderId], references: [id], onDelete: Cascade)
  billNumber  String
  marks       String?
  description String?
  qty         Float
  weight      Float?
  volume      Float?
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
}

model Container {
  id              String   @id @default(uuid())
  orderId         String
  order           Order    @relation(fields: [orderId], references: [id], onDelete: Cascade)
  billNumber      String?
  containerNumber String?
  sealNumber      String?
  containerWeight Float?
  createdAt       DateTime @default(now())
  updatedAt       DateTime @updatedAt
}

model Charge {
  id          String   @id @default(uuid())
  orderId     String
  order       Order    @relation(fields: [orderId], references: [id], onDelete: Cascade)
  description String
  qty         Float
  saleRate    Float
  costRate    Float
  vatPercent  Float
  saleAmount  Float
  costAmount  Float
  vatSale     Float
  vatCost     Float
  totalSale   Float
  totalCost   Float
  currency    String   @default("USD")
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
}

model EmailVerification {
  id        String   @id @default(uuid())
  email     String   @unique
  otp       String
  expiresAt DateTime
  verified  Boolean  @default(false)
  createdAt DateTime @default(now())
}

